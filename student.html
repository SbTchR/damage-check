<!-- student.html  (ouvre via Safari sur les Macs) -->
<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Vérification ordinateur</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.min.css">
<style>
body{margin:20px}
.hidden{display:none}
#section-welcome { text-align:center; margin-bottom:2em; }
</style>
<script>
  // Empêche la fermeture de la fenêtre tant que le formulaire n'a pas été envoyé
  let isSubmitted = false;
  window.addEventListener("beforeunload", function(e) {
    if (!isSubmitted) {
      e.preventDefault();
      e.returnValue = "Tu dois remplir le questionnaire avant de quitter !";
      return "Tu dois remplir le questionnaire avant de quitter !";
    }
  });

  // Change le titre si l'élève essaie d'aller ailleurs
  window.onblur = function() {
    document.title = "⚠️ Reviens sur le formulaire !";
  };
  window.onfocus = function() {
    document.title = "Questionnaire de dégâts";
  };
  </script>
</head>
<body>

<div id="section-welcome" class="section">
  <h2>Bienvenue&nbsp;!</h2>
  <p>
    <b>Avant d’utiliser cet ordinateur, tu dois obligatoirement remplir ce questionnaire.</b><br>
    <span style="color:#0077ff">Tu ne pourras pas quitter cette page tant que le formulaire n’aura pas été rempli.</span><br>
    <br>
    <b>Consigne :</b> <br>
    <ul>
      <li>Signale honnêtement tout problème constaté (clavier, souris, écran, autres).</li>
      <li>Si tout fonctionne, clique simplement sur “Rien à signaler” pour chaque section.</li>
      <li>À la fin, fais valider par le professeur si tu déclares un nouveau dégât.</li>
    </ul>
    <br>
    <i>Merci de ta collaboration pour le respect du matériel !</i>
  </p>
  <button id="welcomeStart" style="font-size:1.2em;padding:0.7em 2em;background:linear-gradient(90deg,#0077ff,#00e0ff);color:#fff;border:none;border-radius:1em;cursor:pointer;">Commencer</button>
</div>

<h2>Ordinateur <span id="pcId"></span></h2>
<p>Utilisateur : <strong id="userId"></strong></p>

<!-- Sections -->
<div id="section-keyboard"  class="section hidden">
  <h3>Clavier</h3>
  <ul id="list-keyboard"></ul>
  <button data-sec="keyboard" data-nothing>Rien à signaler</button>
  <button data-sec="keyboard" data-new>Signaler un nouveau dégât</button>
</div>

<div id="section-mouse"  class="section hidden">
  <h3>Souris / Trackpad</h3>
  <ul id="list-mouse"></ul>
  <button data-sec="mouse" data-nothing>Rien à signaler</button>
  <button data-sec="mouse" data-new>Signaler un nouveau dégât</button>
  <button data-back>Précédent</button>
</div>

<div id="section-screen"  class="section hidden">
  <h3>Écran</h3>
  <ul id="list-screen"></ul>
  <button data-sec="screen" data-nothing>Rien à signaler</button>
  <button data-sec="screen" data-new>Signaler un nouveau dégât</button>
  <button data-back>Précédent</button>
</div>

<div id="section-other"  class="section hidden">
  <h3>Autres</h3>
  <ul id="list-other"></ul>
  <button data-sec="other" data-nothing>Rien à signaler</button>
  <button data-sec="other" data-new>Signaler un nouveau dégât</button>
  <button data-back>Précédent</button>
</div>

<!-- Dialogue nouveau dégât -->
<div id="modal" class="hidden">
  <h4 id="modal-title"></h4>
  <input type="text" id="damageDesc" placeholder="Décris le dégât…" />
  <button id="cancel">Annuler</button>
  <button id="save">Enregistrer</button>
</div>

<!-- Validation professeur -->
<div id="pwdModal" class="hidden">
  <h4>Nouveaux dégâts signalés</h4>
  <ul id="newList"></ul>
  <input type="password" id="pwdInput" placeholder="Mot de passe professeur" />
  <button id="pwdCancel">Annuler</button>
  <button id="pwdOk">Valider</button>
</div>

<script type="module" src="student.js"></script>
</body>
</html>